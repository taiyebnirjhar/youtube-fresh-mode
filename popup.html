// manifest.json
{
  "manifest_version": 3,
  "name": "YouTube Fresh Mode",
  "version": "1.0",
  "description": "Opens YouTube with a clean slate, free from personalized recommendations",
  "permissions": [
    "webRequest",
    "cookies",
    "storage",
    "webRequestBlocking",
    "*://*.youtube.com/*"
  ],
  "host_permissions": [
    "*://*.youtube.com/*"
  ],
  "background": {
    "service_worker": "background.js"
  },
  "action": {
    "default_title": "YouTube Fresh Mode",
    "default_popup": "popup.html"
  },
  "icons": {
    "48": "icon48.png",
    "128": "icon128.png"
  }
}

// background.js
const YOUTUBE_DOMAINS = [
  "youtube.com",
  "www.youtube.com",
  "m.youtube.com"
];

// Cookie properties to clear
const TRACKING_COOKIES = [
  "PREF",
  "VISITOR_INFO1_LIVE",
  "YSC",
  "__Secure-YEC",
  "CONSENT",
  "LOGIN_INFO"
];

// Clear YouTube cookies before loading the page
async function clearYouTubeCookies() {
  for (const domain of YOUTUBE_DOMAINS) {
    for (const cookieName of TRACKING_COOKIES) {
      await chrome.cookies.remove({
        name: cookieName,
        url: `https://${domain}`,
      });
    }
  }
}

// Listen for YouTube navigation
chrome.webRequest.onBeforeRequest.addListener(
  async function(details) {
    if (details.type === "main_frame" && 
        YOUTUBE_DOMAINS.some(domain => details.url.includes(domain))) {
      await clearYouTubeCookies();
    }
  },
  { urls: ["*://*.youtube.com/*"] },
  ["blocking"]
);

// popup.html
<!DOCTYPE html>
<html>
<head>
  <title>YouTube Fresh Mode</title>
  <style>
    body {
      width: 300px;
      padding: 15px;
      font-family: Arial, sans-serif;
    }
    .status {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
    }
    .enabled {
      background-color: #e6ffe6;
      color: #006600;
    }
  </style>
</head>
<body>
  <h2>YouTube Fresh Mode</h2>
  <div class="status enabled">
    Active: YouTube will open without personalized recommendations
  </div>
  <p>
    This extension automatically clears YouTube cookies before loading,
    giving you a fresh, distraction-free experience.
  </p>
</body>
</html>
